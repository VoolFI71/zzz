<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GLS VPN ‚Äî –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥</title>
    <style>
    :root{
      --bg:#0b1020;--bg2:#101634;--glass:rgba(255,255,255,.06);--stroke:rgba(255,255,255,.14);
      --text:#e8ecf8;--muted:#a9b3c9;--primary:#6d8bff;--primary2:#9a6dff;--ok:#22c55e;--warn:#f59e0b
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;font-family:Inter, -apple-system, Segoe UI, Roboto, Arial; color:var(--text);
      background:
        radial-gradient(900px 500px at 15% -10%, #6d8bff22, transparent 60%),
        radial-gradient(1000px 600px at 85% 0%, #9a6dff1f, transparent 60%),
        linear-gradient(180deg, var(--bg), var(--bg2));
      display:flex;align-items:center;justify-content:center;padding:24px
    }
    .blur{position:absolute;filter:blur(80px);opacity:.6;z-index:-1}
    .b1{top:-40px;left:6%;width:280px;height:280px;background:#6d8bff44;border-radius:50%}
    .b2{bottom:-40px;right:10%;width:320px;height:320px;background:#9a6dff33;border-radius:50%}

    .card{width:100%;max-width:900px;border:1px solid var(--stroke);background:var(--glass);
      border-radius:18px;backdrop-filter:blur(10px) saturate(135%);padding:22px 22px 18px}
    .brand{display:flex;align-items:center;gap:12px;margin-bottom:8px}
    .logo{width:36px;height:36px;border-radius:10px;display:grid;place-items:center;
      background:linear-gradient(135deg,var(--primary),var(--primary2));box-shadow:0 10px 40px #6d8bff55;font-weight:800}
    .brand h1{margin:0;font-size:18px;letter-spacing:.6px}
    .subtitle{margin:4px 0 12px;color:var(--muted);font-size:14px}

    .info{display:flex;gap:12px;flex-wrap:wrap;margin:10px 0 16px}
    .chip{border:1px solid var(--stroke);border-radius:10px;padding:8px 10px;background:rgba(255,255,255,.04);font-size:12px}
    .ok{color:var(--ok)}

    .config{
      background:rgba(255,255,255,.05);border:1px dashed var(--stroke);border-radius:12px;padding:12px;
      font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;font-size:12.5px;line-height:1.6;max-height:220px;min-height:120px;overflow:auto
    }

    .actions{display:grid;grid-template-columns:1fr;gap:10px;margin:16px 0}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;border:1px solid var(--stroke);
      background:linear-gradient(135deg,var(--primary),var(--primary2));color:#fff;padding:14px;border-radius:12px;
      font-weight:700;cursor:pointer;text-decoration:none;transition:.2s}
    .btn:hover{transform:translateY(-1px);box-shadow:0 12px 32px #6d8bff55}
    .ghost{background:transparent;color:var(--text)}
    .ghost:hover{border-color:#ffffff55}

    .help{color:var(--muted);font-size:13px;margin-top:6px}

    .toast{position:fixed;left:50%;bottom:24px;transform:translateX(-50%);
      background:#0d1226;color:#e6eaff;border:1px solid var(--stroke);padding:10px 14px;border-radius:10px;opacity:0;
      transition:.3s;pointer-events:none}
    .toast.show{opacity:1;transform:translateX(-50%) translateY(-6px)}

    @media (min-width:860px){
      .brand h1{font-size:20px}
      .subtitle{font-size:15px}
      .actions{grid-template-columns:1fr 1fr}
      .config{max-height:320px;font-size:13.5px}
    }
    @media (max-width:560px){.card{padding:18px}.brand h1{font-size:16px}}
    </style>
</head>
<body>
  <div class="b1 blur"></div><div class="b2 blur"></div>
  <main class="card">
    <div class="brand">
      <div class="logo">‚ö°</div>
      <h1>GLS VPN ‚Äî –ò–º–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥–∞</h1>
        </div>
    <div class="subtitle">–î–æ–±–∞–≤—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ V2rayTun –≤ –æ–¥–∏–Ω –∫–ª–∏–∫</div>

    <div class="info">
      <div class="chip ok" id="platform-chip">üì± –ì–æ—Ç–æ–≤–æ –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ</div>
        </div>

    <div class="config" id="config-text">–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥–∞‚Ä¶</div>

    <div class="actions">
      <a class="btn" id="openBtn">üì≤ –û—Ç–∫—Ä—ã—Ç—å –≤ V2rayTun</a>
      <button class="btn ghost" id="copyBtn">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥</button>
        </div>
    <div class="help">
      –ï—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –æ—Ç–∫—Ä—ã–ª–æ—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚Äî —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥ –∏ –¥–æ–±–∞–≤—å—Ç–µ –µ–≥–æ –≤ V2rayTun –≤—Ä—É—á–Ω—É—é.
    </div>
  </main>

  <div class="toast" id="toast">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ</div>

  <script>
    const qs = new URLSearchParams(location.search);
    const configB64 = qs.get('config');
    const subscriptionParam = qs.get('subscription');
    const tgIdParam = qs.get('tg_id');
    
    const configBox = document.getElementById('config-text');
    const openBtn = document.getElementById('openBtn');
    const copyBtn = document.getElementById('copyBtn');
    const toast = document.getElementById('toast');
    
    function showToast(text){
      toast.textContent = text;
      toast.classList.add('show');
      setTimeout(()=>toast.classList.remove('show'), 1700);
    }
    
    let decoded = '';
    try { decoded = configB64 ? atob(configB64) : ''; } catch { decoded = ''; }
    
    // –¢–µ–∫—É—â–∏–π –∞–¥—Ä–µ—Å —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–±–µ–∑ —Ö—ç—à–∞)
    const currentUrl = location.href;
    
    // –õ–æ–≥–∏–∫–∞, –∫–∞–∫–∞—è —Å—Å—ã–ª–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –ø–æ–ª–µ
    let displayUrl = null;
    if (subscriptionParam) {
      displayUrl = subscriptionParam;
    } else if (tgIdParam) {
      displayUrl = `https://swaga.space/subscription/${encodeURIComponent(tgIdParam)}`;
    } else if (decoded) {
      displayUrl = decoded;
    } else {
      displayUrl = currentUrl; // fallback ‚Äî —Ç–µ–∫—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
    }
    
    configBox.textContent = displayUrl;
    
    // —É–±—Ä–∞–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–¥–ø–∏—Å–∫–∏
    
    // platform hint
    const isMobile = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
    if(!isMobile){ document.getElementById('platform-chip').textContent = 'üñ•Ô∏è –û—Ç–∫—Ä–æ–π—Ç–µ —Å–æ —Å–º–∞—Ä—Ç—Ñ–æ–Ω–∞'; }
    
    // –û—Ç–∫—Ä—ã—Ç—å –≤ V2rayTun ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ–∫—É—â—É—é –≤–∏–¥–∏–º—É—é —Å—Å—ã–ª–∫—É (displayUrl)
    openBtn.addEventListener('click', () => {
      if(!isMobile){ showToast('–û—Ç–∫—Ä–æ–π—Ç–µ —Å–æ —Å–º–∞—Ä—Ç—Ñ–æ–Ω–∞'); return; }
      const target = displayUrl || currentUrl;
      const encoded = encodeURIComponent(target);
      const href = `v2raytun://import/${encoded}`;
      // —Å–æ–∑–¥–∞—ë–º —Å—Å—ã–ª–∫—É –∏ –∫–ª–∏–∫–∞–µ–º ‚Äî —Å–∏—Å—Ç–µ–º–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–∫—Ä–æ–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
      const a = document.createElement('a');
      a.href = href;
      document.body.appendChild(a);
      a.click();
      a.remove();
      setTimeout(()=>{ if(document.hasFocus()) showToast('–ï—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –æ—Ç–∫—Ä—ã–ª–æ—Å—å ‚Äî —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—Å—ã–ª–∫—É'); }, 1200);
    });
    
    // –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å ‚Äî –∫–æ–ø–∏—Ä—É–µ–º —Ç–µ–∫—É—â–∏–π –∞–¥—Ä–µ—Å —Å—Ç—Ä–∞–Ω–∏—Ü—ã (location.href)
    copyBtn.addEventListener('click', async () => {
      const textToCopy = currentUrl;
      if(!textToCopy){ showToast('–î–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã'); return; }
      try{
        if(navigator.clipboard && window.isSecureContext){
          await navigator.clipboard.writeText(textToCopy);
        } else {
          const ta = document.createElement('textarea');
          ta.value = textToCopy; ta.style.position='fixed'; ta.style.opacity='0';
          document.body.appendChild(ta); ta.focus(); ta.select();
          document.execCommand('copy');
          ta.remove();
        }
        showToast('‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ');
      }catch{
        showToast('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å');
      }
    });
    </script>
</body>
</html>